{"remainingRequest":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\src\\views\\AdminInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\src\\views\\AdminInfo.vue","mtime":1611658510000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQWRtaW5JbmZvIiwKICBkYXRhKCkgewogICAgLy8gMi01IOS/ruaUueWvhueggeagoemqjOinhOWImSDkuIDlrpropoHmlL7mnIDliY3pnaIKICAgIHZhciB2YWxpZGF0ZVBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+ivt+i+k+WFpeWvhueggScpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5ydWxlRm9ybS5jaGVja1Bhc3MgIT09ICcnKSB7CiAgICAgICAgICB0aGlzLiRyZWZzLnJ1bGVGb3JtLnZhbGlkYXRlRmllbGQoJ2NoZWNrUGFzcycpOwogICAgICAgIH0KICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CiAgICB9CiAgICB2YXIgdmFsaWRhdGVQYXNzMiA9IChydWxlLCB2YWx1ZSwgY2FsbGJhY2spID0+IHsKICAgICAgaWYgKHZhbHVlID09PSAnJykgewogICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign6K+35YaN5qyh6L6T5YWl5a+G56CBJykpOwogICAgICB9IGVsc2UgaWYgKHZhbHVlICE9PSB0aGlzLnJ1bGVGb3JtLnBhc3MpIHsKICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+S4pOasoei+k+WFpeWvhueggeS4jeS4gOiHtCEnKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY2FsbGJhY2soKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB7CiAgICAgIGFkbWluOiBudWxsLAogICAgICBhZG1pbjI6IG51bGwsIC8vIDEtNSDnvJbovpHnmoTlr7nosaEKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsIC8vIDEtMiDnvJbovpHnlKjmiLfkv6Hmga8KICAgICAgcGFzc3dvcmREaWFsb2dWaXNpYmxlOiBmYWxzZSwgLy8gMi0zIOS/ruaUueWvhueggQoKICAgICAgcnVsZUZvcm06IHsgLy8gMi02IOagoemqjOWvueixoSDop4TliJkKICAgICAgICBwYXNzOiAnJywKICAgICAgICBjaGVja1Bhc3M6ICcnLAogICAgICAgIG9sZFBhc3M6ICcnLCAvLyAyLTkKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBwYXNzOiBbCiAgICAgICAgICB7dmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MsIHRyaWdnZXI6ICdibHVyJ30KICAgICAgICBdLAogICAgICAgIGNoZWNrUGFzczogWwogICAgICAgICAge3ZhbGlkYXRvcjogdmFsaWRhdGVQYXNzMiwgdHJpZ2dlcjogJ2JsdXInfQogICAgICAgIF0sCiAgICAgICAgb2xkUGFzczogWwogICAgICAgICAge3ZhbGlkYXRvcjogdmFsaWRhdGVQYXNzLCB0cmlnZ2VyOiAnYmx1cid9CiAgICAgICAgXQogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pbml0QWRtaW4oKQogIH0sCiAgbWV0aG9kczogewogICAgLy8gMi03IOmihOagoemqjCDmj5DkuqTooajljZUKICAgIHN1Ym1pdEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICAvLyBhbGVydCgnc3VibWl0IScpOwogICAgICAgICAgdGhpcy5ydWxlRm9ybS5hZG1pbklkID0gdGhpcy5hZG1pbi5pZAogICAgICAgICAgdGhpcy5wdXRSZXF1ZXN0KCcvYWRtaW4vcGFzcycsIHRoaXMucnVsZUZvcm0pLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICAgICAgLy8g5pu05paw5a+G56CB5oiQ5Yqf5ZCOIOmAgOWHuueZu+W9lQogICAgICAgICAgICAgIHRoaXMucG9zdFJlcXVlc3QoJy9sb2dvdXQnKSAvLyDpgIDlh7rnmbvlvZUKICAgICAgICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlcicpCiAgICAgICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oJ3Rva2VuU3RyJykKICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2luaXRSb3V0ZXMnLCBbXSkgLy8g5Yid5aeL5YyW6Lev55SxIOiPnOWNlSDnva7nqboKICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSgnLycpIC8vIOi3s+WIsOeZu+W9lemhtemdogoKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yIHN1Ym1pdCEhJyk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyAyLTcg6YeN5Zu05L+u5pS55a+G56CB6KGo5Y2VCiAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsKICAgIH0sCiAgICAvLyAyLTQg5L+u5pS55a+G56CBCiAgICBzaG93VXBkYXRlUGFzc3dvcmRWaWV3KCkgewogICAgICB0aGlzLnBhc3N3b3JkRGlhbG9nVmlzaWJsZSA9IHRydWUKICAgIH0sCiAgICAvLyAxLTkg5pu05paw55So5oi3CiAgICB1cGRhdGVBZG1pbkluZm8oKSB7CiAgICAgIHRoaXMucHV0UmVxdWVzdCgnL2FkbWluL2luZm8nLCB0aGlzLmFkbWluMikudGhlbihyZXNwID0+IHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2UKICAgICAgICAgIHRoaXMuaW5pdEFkbWluKCkKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgLy8gMS00IOe8lui+keeUqOaIt+S/oeaBr+W8ueahhgogICAgc2hvd1VwZGF0ZUFkbWluSW5mb1ZpZXcoKSB7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWUKICAgIH0sCiAgICBpbml0QWRtaW4oKSB7CiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgnL2FkbWluL2luZm8nKS50aGVuKHJlc3AgPT4gewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICB0aGlzLmFkbWluID0gcmVzcAogICAgICAgICAgdGhpcy5hZG1pbjIgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmFkbWluKSAvLyAxLTYg5a+56LGh5ou36LSd57uZIGFkbWluMgogICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ3VzZXInLCBKU09OLnN0cmluZ2lmeShyZXNwKSkKICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnSU5JVF9BRE1JTicsIHJlc3ApCiAgICAgICAgfQogICAgICB9KQogICAgfQogIH0KfQo="},{"version":3,"sources":["AdminInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdminInfo.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <el-card class=\"box-card\" style=\"width: 400px;\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>{{ admin.name }}</span>\n      </div>\n      <div>\n        <div>\n          <div style=\"display: flex;justify-content: center;\">\n            <img title=\"点击修改用户头像\" :src=\"admin.userFace\" style=\"height: 100px;width: 100px;border-radius: 50px;\" alt=\"\">\n          </div>\n          <div>电话号码：\n            <el-tag>{{ admin.telephone }}</el-tag>\n          </div>\n          <div>手机号码：\n            <el-tag>{{ admin.phone }}</el-tag>\n          </div>\n          <div>居住地址：\n            <el-tag>{{ admin.address }}</el-tag>\n          </div>\n          <div>用户标签：\n            <el-tag type=\"success\" v-for=\"(r,index) in admin.roles\" :key=\"index\">{{ r.nameZh }}</el-tag>\n          </div>\n        </div>\n        <div style=\"display: flex;justify-content: space-around;margin-top: 10px;\">\n          <!-- 1-3 @click=\"showUpdateAdminInfoView\" -->\n          <el-button type=\"primary\" size=\"mini\" @click=\"showUpdateAdminInfoView\">修改信息</el-button>\n          <!-- 2-1 用户修改密码 @click=\"showUpdatePasswordView\"  -->\n          <el-button type=\"danger\" size=\"mini\" @click=\"showUpdatePasswordView\">修改密码</el-button>\n        </div>\n      </div>\n    </el-card>\n    <!-- 1-1 编辑用户信息 -->\n    <el-dialog\n        title=\"编辑用户信息\"\n        :visible.sync=\"dialogVisible\"\n        width=\"30%\">\n      <div>\n        <table>\n          <tr>\n            <td>用户昵称：</td>\n            <td>\n              <!-- 1-5 重新给每项赋值 admin2 -->\n              <el-input v-model=\"admin2.name\"></el-input>\n            </td>\n          </tr>\n          <tr>\n            <td>电话号码：</td>\n            <td>\n              <el-input v-model=\"admin2.telephone\"></el-input>\n            </td>\n          </tr>\n          <tr>\n            <td>手机号码：</td>\n            <td>\n              <el-input v-model=\"admin2.phone\"></el-input>\n            </td>\n          </tr>\n          <tr>\n            <td>用户地址：</td>\n            <td>\n              <el-input v-model=\"admin2.address\"></el-input>\n            </td>\n          </tr>\n        </table>\n      </div>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <!-- 1-8 @click=\"updateAdminInfo\" -->\n        <el-button type=\"primary\" @click=\"updateAdminInfo\">确 定</el-button>\n      </span>\n    </el-dialog>\n    <!-- 2-2 修改密码 -->\n    <el-dialog\n        title=\"更新密码\"\n        :visible.sync=\"passwordDialogVisible\"\n        width=\"30%\">\n      <div>\n        <!-- 2-8 调整修改密码表单 -->\n        <el-form :model=\"ruleForm\" status-icon :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\" class=\"demo-ruleForm\">\n          <el-form-item label=\"请输入旧密码\" prop=\"oldPass\">\n            <el-input type=\"password\" v-model=\"ruleForm.oldPass\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"请输入新密码\" prop=\"pass\">\n            <el-input type=\"password\" v-model=\"ruleForm.pass\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"确认新密码\" prop=\"checkPass\">\n            <el-input type=\"password\" v-model=\"ruleForm.checkPass\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item>\n            <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">提交</el-button>\n            <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\n          </el-form-item>\n        </el-form>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n<script>\nexport default {\n  name: \"AdminInfo\",\n  data() {\n    // 2-5 修改密码校验规则 一定要放最前面\n    var validatePass = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else {\n        if (this.ruleForm.checkPass !== '') {\n          this.$refs.ruleForm.validateField('checkPass');\n        }\n        callback();\n      }\n    }\n    var validatePass2 = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码'));\n      } else if (value !== this.ruleForm.pass) {\n        callback(new Error('两次输入密码不一致!'));\n      } else {\n        callback();\n      }\n    }\n\n    return {\n      admin: null,\n      admin2: null, // 1-5 编辑的对象\n      dialogVisible: false, // 1-2 编辑用户信息\n      passwordDialogVisible: false, // 2-3 修改密码\n\n      ruleForm: { // 2-6 校验对象 规则\n        pass: '',\n        checkPass: '',\n        oldPass: '', // 2-9\n      },\n      rules: {\n        pass: [\n          {validator: validatePass, trigger: 'blur'}\n        ],\n        checkPass: [\n          {validator: validatePass2, trigger: 'blur'}\n        ],\n        oldPass: [\n          {validator: validatePass, trigger: 'blur'}\n        ]\n      }\n    }\n  },\n  mounted() {\n    this.initAdmin()\n  },\n  methods: {\n    // 2-7 预校验 提交表单\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          // alert('submit!');\n          this.ruleForm.adminId = this.admin.id\n          this.putRequest('/admin/pass', this.ruleForm).then(resp => {\n            if (resp) {\n              // 更新密码成功后 退出登录\n              this.postRequest('/logout') // 退出登录\n              window.sessionStorage.removeItem('user')\n              window.sessionStorage.removeItem('tokenStr')\n              this.$store.commit('initRoutes', []) // 初始化路由 菜单 置空\n              this.$router.replace('/') // 跳到登录页面\n\n            }\n          })\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n    },\n    // 2-7 重围修改密码表单\n    resetForm(formName) {\n      this.$refs[formName].resetFields();\n    },\n    // 2-4 修改密码\n    showUpdatePasswordView() {\n      this.passwordDialogVisible = true\n    },\n    // 1-9 更新用户\n    updateAdminInfo() {\n      this.putRequest('/admin/info', this.admin2).then(resp => {\n        if (resp) {\n          this.dialogVisible = false\n          this.initAdmin()\n        }\n      })\n    },\n    // 1-4 编辑用户信息弹框\n    showUpdateAdminInfoView() {\n      this.dialogVisible = true\n    },\n    initAdmin() {\n      this.getRequest('/admin/info').then(resp => {\n        if (resp) {\n          this.admin = resp\n          this.admin2 = Object.assign({}, this.admin) // 1-6 对象拷贝给 admin2\n          window.sessionStorage.setItem('user', JSON.stringify(resp))\n          this.$store.commit('INIT_ADMIN', resp)\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}