{"remainingRequest":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\src\\views\\AdminInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\src\\views\\AdminInfo.vue","mtime":1644174182857},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJBZG1pbkluZm8iLAogICAgZGF0YSgpIHsKICAgICAgICAvLyAyLTUg5L+u5pS55a+G56CB5qCh6aqM6KeE5YiZIOS4gOWumuimgeaUvuacgOWJjemdogogICAgICAgIHZhciB2YWxpZGF0ZVBhc3MgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJycpIHsKICAgICAgICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign6K+36L6T5YWl5a+G56CBJykpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKHRoaXMucnVsZUZvcm0uY2hlY2tQYXNzICE9PSAnJykgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHJlZnMucnVsZUZvcm0udmFsaWRhdGVGaWVsZCgnY2hlY2tQYXNzJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHZhciB2YWxpZGF0ZVBhc3MyID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICAgICAgICBpZiAodmFsdWUgPT09ICcnKSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+ivt+WGjeasoei+k+WFpeWvhueggScpKTsKICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSAhPT0gdGhpcy5ydWxlRm9ybS5wYXNzKSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ+S4pOasoei+k+WFpeWvhueggeS4jeS4gOiHtCEnKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBoZWFkZXI6IHsKICAgICAgICAgICAgICAgIEF1dGhvcml6YXRpb246IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCd0b2tlblN0cicpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGFkbWluOiBudWxsLAogICAgICAgICAgICBhZG1pbjI6IG51bGwsIC8vIDEtNSDnvJbovpHnmoTlr7nosaEKICAgICAgICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsIC8vIDEtMiDnvJbovpHnlKjmiLfkv6Hmga8KICAgICAgICAgICAgcGFzc3dvcmREaWFsb2dWaXNpYmxlOiBmYWxzZSwgLy8gMi0zIOS/ruaUueWvhueggQoKICAgICAgICAgICAgcnVsZUZvcm06IHsgLy8gMi02IOagoemqjOWvueixoSDop4TliJkKICAgICAgICAgICAgICAgIHBhc3M6ICcnLAogICAgICAgICAgICAgICAgY2hlY2tQYXNzOiAnJywKICAgICAgICAgICAgICAgIG9sZFBhc3M6ICcnLCAvLyAyLTkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcnVsZXM6IHsKICAgICAgICAgICAgICAgIHBhc3M6IFsKICAgICAgICAgICAgICAgICAgICB7dmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MsIHRyaWdnZXI6ICdibHVyJ30KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICBjaGVja1Bhc3M6IFsKICAgICAgICAgICAgICAgICAgICB7dmFsaWRhdG9yOiB2YWxpZGF0ZVBhc3MyLCB0cmlnZ2VyOiAnYmx1cid9CiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgb2xkUGFzczogWwogICAgICAgICAgICAgICAgICAgIHt2YWxpZGF0b3I6IHZhbGlkYXRlUGFzcywgdHJpZ2dlcjogJ2JsdXInfQogICAgICAgICAgICAgICAgXQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5pbml0QWRtaW4oKQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBvblN1Y2Nlc3MoKSB7CiAgICAgICAgICAgIHRoaXMuaW5pdEFkbWluKCk7CiAgICAgICAgfSwKICAgICAgICAvLyAyLTcg6aKE5qCh6aqMIOaPkOS6pOihqOWNlQogICAgICAgIHN1Ym1pdEZvcm0oZm9ybU5hbWUpIHsKICAgICAgICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgICAgICAgICAgICAvLyBhbGVydCgnc3VibWl0IScpOwogICAgICAgICAgICAgICAgICAgIHRoaXMucnVsZUZvcm0uYWRtaW5JZCA9IHRoaXMuYWRtaW4uaWQKICAgICAgICAgICAgICAgICAgICB0aGlzLnB1dFJlcXVlc3QoJy9hZG1pbi9wYXNzJywgdGhpcy5ydWxlRm9ybSkudGhlbihyZXNwID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIOabtOaWsOWvhueggeaIkOWKn+WQjiDpgIDlh7rnmbvlvZUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucG9zdFJlcXVlc3QoJy9sb2dvdXQnKSAvLyDpgIDlh7rnmbvlvZUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlblN0cicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ2luaXRSb3V0ZXMnLCBbXSkgLy8g5Yid5aeL5YyW6Lev55SxIOiPnOWNlSDnva7nqboKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKCcvJykgLy8g6Lez5Yiw55m75b2V6aG16Z2iCgogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Vycm9yIHN1Ym1pdCEhJyk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIC8vIDItNyDph43lm7Tkv67mlLnlr4bnoIHooajljZUKICAgICAgICByZXNldEZvcm0oZm9ybU5hbWUpIHsKICAgICAgICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0ucmVzZXRGaWVsZHMoKTsKICAgICAgICB9LAogICAgICAgIC8vIDItNCDkv67mlLnlr4bnoIEKICAgICAgICBzaG93VXBkYXRlUGFzc3dvcmRWaWV3KCkgewogICAgICAgICAgICB0aGlzLnBhc3N3b3JkRGlhbG9nVmlzaWJsZSA9IHRydWUKICAgICAgICB9LAogICAgICAgIC8vIDEtOSDmm7TmlrDnlKjmiLcKICAgICAgICB1cGRhdGVBZG1pbkluZm8oKSB7CiAgICAgICAgICAgIHRoaXMucHV0UmVxdWVzdCgnL2FkbWluL2luZm8nLCB0aGlzLmFkbWluMikudGhlbihyZXNwID0+IHsKICAgICAgICAgICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgICAgICB0aGlzLmluaXRBZG1pbigpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICAvLyAxLTQg57yW6L6R55So5oi35L+h5oGv5by55qGGCiAgICAgICAgc2hvd1VwZGF0ZUFkbWluSW5mb1ZpZXcoKSB7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWUKICAgICAgICB9LAogICAgICAgIGluaXRBZG1pbigpIHsKICAgICAgICAgICAgdGhpcy5nZXRSZXF1ZXN0KCcvYWRtaW4vaW5mbycpLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuYWRtaW4gPSByZXNwCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZG1pbjIgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmFkbWluKSAvLyAxLTYg5a+56LGh5ou36LSd57uZIGFkbWluMgogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCd1c2VyJywgSlNPTi5zdHJpbmdpZnkocmVzcCkpCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdJTklUX0FETUlOJywgcmVzcCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICB9Cn0K"},{"version":3,"sources":["AdminInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AdminInfo.vue","sourceRoot":"src/views","sourcesContent":["<template>\n    <div>\n        <el-card class=\"box-card\" style=\"width: 400px;\">\n            <div slot=\"header\" class=\"clearfix\">\n                <span>{{ admin.name }}</span>\n            </div>\n            <div>\n                <div>\n                    <div style=\"display: flex;justify-content: center;\">\n                        <el-upload\n                                action=\"/admin/userface\"\n                                :headers=\"header\"\n                                :data=\"admin\"\n                                show-file-list=\"false\"\n                                :on-success=\"onSuccess\">\n                            <img title=\"点击修改用户头像\" :src=\"admin.userFace\"\n                                 style=\"height: 100px;width: 100px;border-radius: 50px;\" alt=\"\">\n                        </el-upload>\n                    </div>\n                    <div>电话号码：\n                        <el-tag>{{ admin.telephone }}</el-tag>\n                    </div>\n                    <div>手机号码：\n                        <el-tag>{{ admin.phone }}</el-tag>\n                    </div>\n                    <div>居住地址：\n                        <el-tag>{{ admin.address }}</el-tag>\n                    </div>\n                    <div>用户标签：\n                        <el-tag type=\"success\" v-for=\"(r,index) in admin.roles\" :key=\"index\">{{ r.nameZh }}</el-tag>\n                    </div>\n                </div>\n                <div style=\"display: flex;justify-content: space-around;margin-top: 10px;\">\n                    <!-- 1-3 @click=\"showUpdateAdminInfoView\" -->\n                    <el-button type=\"primary\" size=\"mini\" @click=\"showUpdateAdminInfoView\">修改信息</el-button>\n                    <!-- 2-1 用户修改密码 @click=\"showUpdatePasswordView\"  -->\n                    <el-button type=\"danger\" size=\"mini\" @click=\"showUpdatePasswordView\">修改密码</el-button>\n                </div>\n            </div>\n        </el-card>\n        <!-- 1-1 编辑用户信息 -->\n        <el-dialog\n                title=\"编辑用户信息\"\n                :visible.sync=\"dialogVisible\"\n                width=\"30%\">\n            <div>\n                <table>\n                    <tr>\n                        <td>用户昵称：</td>\n                        <td>\n                            <!-- 1-5 重新给每项赋值 admin2 -->\n                            <el-input v-model=\"admin2.name\"></el-input>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>电话号码：</td>\n                        <td>\n                            <el-input v-model=\"admin2.telephone\"></el-input>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>手机号码：</td>\n                        <td>\n                            <el-input v-model=\"admin2.phone\"></el-input>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>用户地址：</td>\n                        <td>\n                            <el-input v-model=\"admin2.address\"></el-input>\n                        </td>\n                    </tr>\n                </table>\n            </div>\n            <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n                <!-- 1-8 @click=\"updateAdminInfo\" -->\n        <el-button type=\"primary\" @click=\"updateAdminInfo\">确 定</el-button>\n      </span>\n        </el-dialog>\n        <!-- 2-2 修改密码 -->\n        <el-dialog\n                title=\"更新密码\"\n                :visible.sync=\"passwordDialogVisible\"\n                width=\"30%\">\n            <div>\n                <!-- 2-8 调整修改密码表单 -->\n                <el-form :model=\"ruleForm\" status-icon :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\"\n                         class=\"demo-ruleForm\">\n                    <el-form-item label=\"请输入旧密码\" prop=\"oldPass\">\n                        <el-input type=\"password\" v-model=\"ruleForm.oldPass\" autocomplete=\"off\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"请输入新密码\" prop=\"pass\">\n                        <el-input type=\"password\" v-model=\"ruleForm.pass\" autocomplete=\"off\"></el-input>\n                    </el-form-item>\n                    <el-form-item label=\"确认新密码\" prop=\"checkPass\">\n                        <el-input type=\"password\" v-model=\"ruleForm.checkPass\" autocomplete=\"off\"></el-input>\n                    </el-form-item>\n                    <el-form-item>\n                        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">提交</el-button>\n                        <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\n                    </el-form-item>\n                </el-form>\n            </div>\n        </el-dialog>\n    </div>\n</template>\n<script>\n    export default {\n        name: \"AdminInfo\",\n        data() {\n            // 2-5 修改密码校验规则 一定要放最前面\n            var validatePass = (rule, value, callback) => {\n                if (value === '') {\n                    callback(new Error('请输入密码'));\n                } else {\n                    if (this.ruleForm.checkPass !== '') {\n                        this.$refs.ruleForm.validateField('checkPass');\n                    }\n                    callback();\n                }\n            }\n            var validatePass2 = (rule, value, callback) => {\n                if (value === '') {\n                    callback(new Error('请再次输入密码'));\n                } else if (value !== this.ruleForm.pass) {\n                    callback(new Error('两次输入密码不一致!'));\n                } else {\n                    callback();\n                }\n            }\n\n            return {\n                header: {\n                    Authorization: window.sessionStorage.getItem('tokenStr')\n                },\n                admin: null,\n                admin2: null, // 1-5 编辑的对象\n                dialogVisible: false, // 1-2 编辑用户信息\n                passwordDialogVisible: false, // 2-3 修改密码\n\n                ruleForm: { // 2-6 校验对象 规则\n                    pass: '',\n                    checkPass: '',\n                    oldPass: '', // 2-9\n                },\n                rules: {\n                    pass: [\n                        {validator: validatePass, trigger: 'blur'}\n                    ],\n                    checkPass: [\n                        {validator: validatePass2, trigger: 'blur'}\n                    ],\n                    oldPass: [\n                        {validator: validatePass, trigger: 'blur'}\n                    ]\n                }\n            }\n        },\n        mounted() {\n            this.initAdmin()\n        },\n        methods: {\n            onSuccess() {\n                this.initAdmin();\n            },\n            // 2-7 预校验 提交表单\n            submitForm(formName) {\n                this.$refs[formName].validate((valid) => {\n                    if (valid) {\n                        // alert('submit!');\n                        this.ruleForm.adminId = this.admin.id\n                        this.putRequest('/admin/pass', this.ruleForm).then(resp => {\n                            if (resp) {\n                                // 更新密码成功后 退出登录\n                                this.postRequest('/logout') // 退出登录\n                                window.sessionStorage.removeItem('user')\n                                window.sessionStorage.removeItem('tokenStr')\n                                this.$store.commit('initRoutes', []) // 初始化路由 菜单 置空\n                                this.$router.replace('/') // 跳到登录页面\n\n                            }\n                        })\n                    } else {\n                        console.log('error submit!!');\n                        return false;\n                    }\n                });\n            },\n            // 2-7 重围修改密码表单\n            resetForm(formName) {\n                this.$refs[formName].resetFields();\n            },\n            // 2-4 修改密码\n            showUpdatePasswordView() {\n                this.passwordDialogVisible = true\n            },\n            // 1-9 更新用户\n            updateAdminInfo() {\n                this.putRequest('/admin/info', this.admin2).then(resp => {\n                    if (resp) {\n                        this.dialogVisible = false\n                        this.initAdmin()\n                    }\n                })\n            },\n            // 1-4 编辑用户信息弹框\n            showUpdateAdminInfoView() {\n                this.dialogVisible = true\n            },\n            initAdmin() {\n                this.getRequest('/admin/info').then(resp => {\n                    if (resp) {\n                        this.admin = resp\n                        this.admin2 = Object.assign({}, this.admin) // 1-6 对象拷贝给 admin2\n                        window.sessionStorage.setItem('user', JSON.stringify(resp))\n                        this.$store.commit('INIT_ADMIN', resp)\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>\n"]}]}