{"remainingRequest":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\src\\views\\sys\\SysAdmin.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\src\\views\\sys\\SysAdmin.vue","mtime":1611658510000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiU3lzQWRtaW4iLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhZG1pbnM6IFtdLCAvLyAzCiAgICAgIGtleXdvcmRzOiAnJywgLy8gOOOAgeaQnOe0ouWFs+mUruWtlwogICAgICBhbGxSb2xlczogW10sIC8vIDE444CB5pu05paw5pON5L2c5ZGY6KeS6ImyCiAgICAgIHNlbGVjdGVkUm9sZXM6IFtdIC8vIDIzCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5pbml0QWRtaW5zKCkgLy8gNQogIH0sCiAgbWV0aG9kczogewogICAgLy8gMjXjgIHmm7TmlrDmk43kvZzlkZjop5LoibIKICAgIGhpZGVQb3AoYWRtaW4pIHsKICAgICAgbGV0IHJvbGVzID0gW10KICAgICAgT2JqZWN0LmFzc2lnbihyb2xlcywgYWRtaW4ucm9sZXMpIC8vIOaLt+i0neWvueixoQogICAgICBsZXQgZmxhZyA9IGZhbHNlCiAgICAgIC8vIOWmguaenOmAieS4reeahOinkuiJsiBpZCDnmoTplb/luqblkozljp/mnaXnmoTkuI3kuIDmoLcKICAgICAgaWYgKHJvbGVzLmxlbmd0aCAhPSB0aGlzLnNlbGVjdGVkUm9sZXMubGVuZ3RoKSB7IC8vIOeUqOaIt+WvueW6lOinkuiJsmlkCiAgICAgICAgZmxhZyA9IHRydWUKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyDop5LoibIgaWQg6ZW/5bqm5ZKM5Y6f5p2l55qE5LiA5qC377yM5L2G5Y+v6IO96KeS6Imy5LiN5LiA5qC3CiAgICAgICAgLy8g5YWI5b6q546vIGFkbWluLnJvbGVzCiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByb2xlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgbGV0IHJvbGUgPSByb2xlc1tpXSAvLyDnlKjmiLflr7nlupTnmoTop5LoibLlr7nosaEKICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5zZWxlY3RlZFJvbGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgIGxldCBzciA9IHRoaXMuc2VsZWN0ZWRSb2xlc1tqXSAgLy8g5ou/5Yiw55So5oi35a+55bqU55qE6KeS6Imy5a+56LGh55qEaWQKICAgICAgICAgICAgaWYgKHJvbGUuaWQgPT0gc3IpIHsgLy8g6KeS6Imy5LiA5qC3CiAgICAgICAgICAgICAgcm9sZXMuc3BsaWNlKGksIDEpIC8vIOWIoOmZpAogICAgICAgICAgICAgIGktLQogICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHJvbGVzLmxlbmd0aCAhPSAwKSB7CiAgICAgICAgICBmbGFnID0gdHJ1ZQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoZmxhZykgewogICAgICAgIC8vIOaLvOaOpSB1cmwo5Y+C5pWw5Li6IGFkbWluSWTjgIHop5LoibIgcmlkcyApCiAgICAgICAgbGV0IHVybCA9ICcvc3lzdGVtL2FkbWluL3JvbGU/YWRtaW5JZD0nICsgYWRtaW4uaWQ7CiAgICAgICAgdGhpcy5zZWxlY3RlZFJvbGVzLmZvckVhY2goc3IgPT4gewogICAgICAgICAgdXJsICs9ICcmcmlkcz0nICsgc3IKICAgICAgICB9KTsKICAgICAgICB0aGlzLnB1dFJlcXVlc3QodXJsKS50aGVuKHJlc3AgPT4gewogICAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgICAgdGhpcy5pbml0QWRtaW5zKCkKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIC8vIDIx44CB5LiL5ouJ5qGG6I635Y+W5omA5pyJ55So5oi36KeS6ImyCiAgICBzaG93UG9wKGFkbWluKSB7CiAgICAgIHRoaXMuaW5pdEFsbFJvbGVzKCkKICAgICAgbGV0IHJvbGVzID0gYWRtaW4ucm9sZXMgLy8g5ou/5Yiw5pW05Liq5pWw57uECiAgICAgIHRoaXMuc2VsZWN0ZWRSb2xlcyA9IFtdCiAgICAgIHJvbGVzLmZvckVhY2gociA9PiB7CiAgICAgICAgdGhpcy5zZWxlY3RlZFJvbGVzLnB1c2goci5pZCkgLy8gci5pZCDnm7jlkIznmoTop5LoibLmlL7ov5vmlbDnu4QKICAgICAgfSkKICAgIH0sCiAgICAvLyAxOeOAgeiOt+WPluaJgOacieaTjeS9nOWRmAogICAgaW5pdEFsbFJvbGVzKCkgewogICAgICB0aGlzLmdldFJlcXVlc3QoJyAvc3lzdGVtL2FkbWluL3JvbGVzJykudGhlbihyZXNwID0+IHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgdGhpcy5hbGxSb2xlcyA9IHJlc3AKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgLy8gMTXjgIHmm7TmlrDmk43kvZzlkZgKICAgIGVuYWJsZWRDaGFuZ2UoYWRtaW4pIHsKICAgICAgdGhpcy5wdXRSZXF1ZXN0KCcvc3lzdGVtL2FkbWluLycsIGFkbWluKS50aGVuKHJlc3AgPT4gewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICB0aGlzLmluaXRBZG1pbnMoKQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyAxM+OAgeWIoOmZpOaTjeS9nOWRmAogICAgZGVsZXRlQWRtaW4oYWRtaW4pIHsKICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG5rC45LmF5Yig6Zmk6K+lWycgKyBhZG1pbi5uYW1lICsgJ10sIOaYr+WQpue7p+e7rT8nLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy5kZWxldGVSZXF1ZXN0KCcvc3lzdGVtL2FkbWluLycgKyBhZG1pbi5pZCkudGhlbihyZXNwID0+IHsKICAgICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICAgIHRoaXMuaW5pdEFkbWlucygpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfSkuY2F0Y2goKCkgPT4gewogICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgdHlwZTogJ2luZm8nLAogICAgICAgICAgbWVzc2FnZTogJ+W3suWPlua2iOWIoOmZpCcKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgLy8gMTAg5pCc57SiCiAgICBkb1NlYXJjaCgpIHsKICAgICAgdGhpcy5pbml0QWRtaW5zKCkKICAgIH0sCiAgICAvLyA044CB6I635Y+W5omA5pyJ5pON5L2c5ZGY77ybMTHjgIHliqDlj4LmlbDlhbPplK7lrZcKICAgIGluaXRBZG1pbnMoKSB7CiAgICAgIHRoaXMuZ2V0UmVxdWVzdCgnL3N5c3RlbS9hZG1pbi8/a2V5d29yZHM9JyArIHRoaXMua2V5d29yZHMpLnRoZW4ocmVzcCA9PiB7CiAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgIHRoaXMuYWRtaW5zID0gcmVzcAogICAgICAgIH0KICAgICAgfSkKICAgIH0KICB9Cn0K"},{"version":3,"sources":["SysAdmin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SysAdmin.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\n  <div>\n    <!-- 1、 -->\n    <div style=\"display: flex;justify-content: center;margin-top: 10px;\">\n      <!-- 9、v-model=\"keywords\" \\ @click=\"doSearch\">搜索 -->\n      <el-input v-model=\"keywords\" placeholder=\"通过用户名搜索用户...\" prefix-icon=\"el-icon-search\"\n                style=\"width: 400px;margin-right: 10px;\"></el-input>\n      <el-button type=\"primary\" icon=\"el-icon-search\" @click=\"doSearch\">搜索</el-button>\n    </div>\n    <!-- 2、6、 -->\n    <div class=\"admin-container\">\n      <el-card class=\"admin-card\" v-for=\"(admin,index) in admins\" :key=\"index\">\n        <div slot=\"header\" class=\"clearfix\">\n          <span>{{ admin.name }}</span>\n          <!-- 12、 @click=\"deleteAdmin(admin)\" -->\n          <el-button style=\"float: right; padding: 3px 0;color:red;\" type=\"text\" icon=\"el-icon-delete\"\n                     @click=\"deleteAdmin(admin)\"></el-button>\n        </div>\n        <div>\n          <div class=\"img-container\">\n            <img :src=\"admin.userFace\" :alt=\"admin.name\" :title=\"admin.name\" class=\"userFace-img\">\n          </div>\n        </div>\n        <div class=\"userinfo-container\">\n          <div>用户名：{{ admin.name }}</div>\n          <div>手机号码：{{ admin.phone }}</div>\n          <div>电话号码：{{ admin.telephone }}</div>\n          <div>地址：{{ admin.address }}</div>\n          <div>用户状态：\n            <!-- 14、更新操作员 @change=\"enabledChange(admin)\" -->\n            <el-switch\n                v-model=\"admin.enabled\"\n                active-color=\"#13ce66\"\n                inactive-color=\"#ff4949\"\n                @change=\"enabledChange(admin)\"\n                active-text=\"启用\"\n                inactive-text=\"禁用\">\n            </el-switch>\n          </div>\n          <div>\n            用户角色：\n            <el-tag style=\"margin-right: 4px;\" type=\"success\" v-for=\"(role,index) in admin.roles\" :key=\"index\">\n              {{ role.nameZh }}\n            </el-tag>\n            <!-- 16、更新操作员角色 弹出框、选择器、 -->\n            <!-- 20、@show=\"showPop(admin)\" -->\n            <!-- 24、@hide=\"hidePop(admin)\" hide 隐藏时触发-->\n            <el-popover\n                placement=\"right\"\n                title=\"角色列表\"\n                width=\"200\"\n                @show=\"showPop(admin)\"\n                @hide=\"hidePop(admin)\"\n                trigger=\"click\">\n              <!-- 17、更新操作员角色 下拉框 -->\n              <!-- 22、v-model=\"selectedRoles\" 存的是1个角色id，multiple 多选，显示已有角色 -->\n              <el-select v-model=\"selectedRoles\" multiple placeholder=\"请选择\">\n                <el-option\n                    v-for=\"(r,index) in allRoles\"\n                    :key=\"index\"\n                    :label=\"r.nameZh\"\n                    :value=\"r.id\">\n                </el-option>\n              </el-select>\n              <!-- 3个点按钮 ... -->\n              <el-button slot=\"reference\" type=\"text\" icon=\"el-icon-more\"></el-button>\n            </el-popover>\n          </div>\n          <div>备注：{{ admin.remark }}</div>\n        </div>\n      </el-card>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  name: \"SysAdmin\",\n  data() {\n    return {\n      admins: [], // 3\n      keywords: '', // 8、搜索关键字\n      allRoles: [], // 18、更新操作员角色\n      selectedRoles: [] // 23\n    }\n  },\n  mounted() {\n    this.initAdmins() // 5\n  },\n  methods: {\n    // 25、更新操作员角色\n    hidePop(admin) {\n      let roles = []\n      Object.assign(roles, admin.roles) // 拷贝对象\n      let flag = false\n      // 如果选中的角色 id 的长度和原来的不一样\n      if (roles.length != this.selectedRoles.length) { // 用户对应角色id\n        flag = true\n      } else {\n        // 角色 id 长度和原来的一样，但可能角色不一样\n        // 先循环 admin.roles\n        for (let i = 0; i < roles.length; i++) {\n          let role = roles[i] // 用户对应的角色对象\n          for (let j = 0; j < this.selectedRoles.length; j++) {\n            let sr = this.selectedRoles[j]  // 拿到用户对应的角色对象的id\n            if (role.id == sr) { // 角色一样\n              roles.splice(i, 1) // 删除\n              i--\n              break\n            }\n          }\n        }\n        if (roles.length != 0) {\n          flag = true\n        }\n      }\n      if (flag) {\n        // 拼接 url(参数为 adminId、角色 rids )\n        let url = '/system/admin/role?adminId=' + admin.id;\n        this.selectedRoles.forEach(sr => {\n          url += '&rids=' + sr\n        });\n        this.putRequest(url).then(resp => {\n          if (resp) {\n            this.initAdmins()\n          }\n        });\n      }\n    },\n    // 21、下拉框获取所有用户角色\n    showPop(admin) {\n      this.initAllRoles()\n      let roles = admin.roles // 拿到整个数组\n      this.selectedRoles = []\n      roles.forEach(r => {\n        this.selectedRoles.push(r.id) // r.id 相同的角色放进数组\n      })\n    },\n    // 19、获取所有操作员\n    initAllRoles() {\n      this.getRequest(' /system/admin/roles').then(resp => {\n        if (resp) {\n          this.allRoles = resp\n        }\n      })\n    },\n    // 15、更新操作员\n    enabledChange(admin) {\n      this.putRequest('/system/admin/', admin).then(resp => {\n        if (resp) {\n          this.initAdmins()\n        }\n      })\n    },\n    // 13、删除操作员\n    deleteAdmin(admin) {\n      this.$confirm('此操作将永久删除该[' + admin.name + '], 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.deleteRequest('/system/admin/' + admin.id).then(resp => {\n          if (resp) {\n            this.initAdmins()\n          }\n        })\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    // 10 搜索\n    doSearch() {\n      this.initAdmins()\n    },\n    // 4、获取所有操作员；11、加参数关键字\n    initAdmins() {\n      this.getRequest('/system/admin/?keywords=' + this.keywords).then(resp => {\n        if (resp) {\n          this.admins = resp\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style>\n/* 7 */\n.admin-container {\n  margin-top: 10px;\n  display: flex;\n  justify-content: space-around; /* 在弹性盒对象的 <div> 元素中的各项周围留有空白：*/\n  flex-wrap: wrap; /* 自动换行 */\n}\n\n.admin-card {\n  width: 350px;\n  margin-bottom: 20px;\n}\n\n.userFace-img {\n  width: 72px;\n  height: 72px;\n  border-radius: 72px;\n}\n\n/* 头像居中 */\n.img-container {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n}\n\n.userinfo-container {\n  font-size: 12px;\n  color: #3e9ef5;\n}\n</style>\n"]}]}