{"remainingRequest":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\thread-loader\\dist\\cjs.js!D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\babel-loader\\lib\\index.js!D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\src\\store\\index.js","dependencies":[{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\src\\store\\index.js","mtime":1611658510000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\babel.config.js","mtime":1611658510000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\广理学习\\JAVA框架项目\\乐字节-云E办\\乐字节-云E办前端\\yeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuanNvbi5zdHJpbmdpZnkuanMiOwppbXBvcnQgVnVlIGZyb20gJ3Z1ZSc7CmltcG9ydCBWdWV4IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyBnZXRSZXF1ZXN0IH0gZnJvbSAiQC91dGlscy9hcGkiOwppbXBvcnQgU29ja0pTIGZyb20gJ3NvY2tqcy1jbGllbnQnOyAvLyAyLTEg5Zyo57q/6IGK5aSpLeWvvOWFpeS4i+i9veeahOWcqOe6v+iBiuWkqeS+nei1lgoKaW1wb3J0IFN0b21wIGZyb20gJ3N0b21wanMnOyAvLyAyLTEg5Zyo57q/6IGK5aSpLeWvvOWFpeS4i+i9veeahOWcqOe6v+iBiuWkqeS+nei1lgoKaW1wb3J0IHsgTm90aWZpY2F0aW9uIH0gZnJvbSAnZWxlbWVudC11aSc7ClZ1ZS51c2UoVnVleCk7CnZhciBub3cgPSBuZXcgRGF0ZSgpOyAvLyDlr7zlhaUgVnVleAoKdmFyIHN0b3JlID0gbmV3IFZ1ZXguU3RvcmUoewogIHN0YXRlOiB7CiAgICByb3V0ZXM6IFtdLAogICAgc2Vzc2lvbnM6IHt9LAogICAgLy8gc2Vzc2lvbnM6IFtdLAogICAgLy8gMS0xIOeUqOadpeaOpeaUtuWQjuerr+aOpeWPo+i/lOWbnueahOaVsOaNrgogICAgYWRtaW5zOiBbXSwKICAgIGN1cnJlbnRBZG1pbjogSlNPTi5wYXJzZSh3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndXNlcicpKSwKICAgIC8vIOW9k+WJjeeUqOaItwogICAgY3VycmVudFNlc3Npb246IG51bGwsCiAgICAvLyBjdXJyZW50U2Vzc2lvbjogLTEsCiAgICBmaWx0ZXJLZXk6ICcnLAogICAgc3RvbXA6IG51bGwsCiAgICAvLyAyLTIg5Zyo57q/6IGK5aSpLeWumuS5ieWvueixoQogICAgaWREb3Q6IHt9IC8vIOacquivu+a2iOaBryDlr7nosaEKCiAgfSwKICBtdXRhdGlvbnM6IHsKICAgIC8vIOS4jiBzdGF0ZSDlkIzmraXmiafooYzvvJvlj6/ku6XmlLnlj5ggc3RhdGUg5a+55bqU55qE5YC855qE5pa55rOVCiAgICAvLyDnvJbovpHnlKjmiLcg5ZCM5q2l55So5oi35L+h5oGvCiAgICBJTklUX0FETUlOOiBmdW5jdGlvbiBJTklUX0FETUlOKHN0YXRlLCBhZG1pbikgewogICAgICBzdGF0ZS5jdXJyZW50QWRtaW4gPSBhZG1pbjsKICAgIH0sCiAgICAvLyDliJ3lp4vljJbot6/nlLEg6I+c5Y2VCiAgICBpbml0Um91dGVzOiBmdW5jdGlvbiBpbml0Um91dGVzKHN0YXRlLCBkYXRhKSB7CiAgICAgIHN0YXRlLnJvdXRlcyA9IGRhdGE7CiAgICB9LAogICAgY2hhbmdlY3VycmVudFNlc3Npb246IGZ1bmN0aW9uIGNoYW5nZWN1cnJlbnRTZXNzaW9uKHN0YXRlLCBjdXJyZW50U2Vzc2lvbikgewogICAgICBzdGF0ZS5jdXJyZW50U2Vzc2lvbiA9IGN1cnJlbnRTZXNzaW9uOyAvLyDlt7Lor7vmtojmga8g5bCP57qi54K55raI5aSxCgogICAgICBWdWUuc2V0KHN0YXRlLmlkRG90LCBzdGF0ZS5jdXJyZW50QWRtaW4udXNlcm5hbWUgKyAnIycgKyBzdGF0ZS5jdXJyZW50U2Vzc2lvbi51c2VybmFtZSwgZmFsc2UpOwogICAgfSwKICAgIGFkZE1lc3NhZ2U6IGZ1bmN0aW9uIGFkZE1lc3NhZ2Uoc3RhdGUsIG1zZykgewogICAgICB2YXIgbXNzID0gc3RhdGUuc2Vzc2lvbnNbc3RhdGUuY3VycmVudEFkbWluLnVzZXJuYW1lICsgJyMnICsgbXNnLnRvXTsKCiAgICAgIGlmICghbXNzKSB7CiAgICAgICAgLy8gc3RhdGUuc2Vzc2lvbnNbc3RhdGUuY3VycmVudEFkbWluLnVzZXJuYW1lICsgJyMnICsgbXNnLnRvXSA9IFtdCiAgICAgICAgVnVlLnNldChzdGF0ZS5zZXNzaW9ucywgc3RhdGUuY3VycmVudEFkbWluLnVzZXJuYW1lICsgJyMnICsgbXNnLnRvLCBbXSk7CiAgICAgIH0KCiAgICAgIHN0YXRlLnNlc3Npb25zW3N0YXRlLmN1cnJlbnRBZG1pbi51c2VybmFtZSArICcjJyArIG1zZy50b10ucHVzaCh7CiAgICAgICAgY29udGVudDogbXNnLmNvbnRlbnQsCiAgICAgICAgZGF0ZTogbmV3IERhdGUoKSwKICAgICAgICBzZWxmOiAhbXNnLm5vdFNlbGYgLy8g5LiN5piv6Ieq5bexCgogICAgICB9KTsKICAgIH0sCiAgICBJTklUX0RBVEE6IGZ1bmN0aW9uIElOSVRfREFUQShzdGF0ZSkgewogICAgICAvLyAxLTIg5rOo6YeK6L+Z5LiA5q61IOa1j+iniOWZqOacrOWcsOeahOWOhuWPsuiBiuWkqeiusOW9lQogICAgICB2YXIgZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd2dWUtY2hhdC1zZXNzaW9uJyk7IC8vY29uc29sZS5sb2coZGF0YSkKCiAgICAgIGlmIChkYXRhKSB7CiAgICAgICAgc3RhdGUuc2Vzc2lvbnMgPSBKU09OLnBhcnNlKGRhdGEpOwogICAgICB9CiAgICB9LAogICAgLy8gMS0zIOWIneWni+WMluaVsOaNrgogICAgSU5JVF9BRE1JTlM6IGZ1bmN0aW9uIElOSVRfQURNSU5TKHN0YXRlLCBkYXRhKSB7CiAgICAgIHN0YXRlLmFkbWlucyA9IGRhdGE7CiAgICB9CiAgfSwKICAvLyDlvILmraXmiafooYwKICBhY3Rpb25zOiB7CiAgICAvLyAyLTMg5Zyo57q/6IGK5aSpOyBjb250ZXh0IOS4iuS4i+aWhwogICAgY29ubmVjdDogZnVuY3Rpb24gY29ubmVjdChjb250ZXh0KSB7CiAgICAgIGNvbnRleHQuc3RhdGUuc3RvbXAgPSBTdG9tcC5vdmVyKG5ldyBTb2NrSlMoJy93cy9lcCcpKTsgLy8g6L+e5o6l56uv54K5CgogICAgICB2YXIgdG9rZW4gPSB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgndG9rZW5TdHInKTsKICAgICAgY29udGV4dC5zdGF0ZS5zdG9tcC5jb25uZWN0KHsKICAgICAgICAnQXV0aC1Ub2tlbic6IHRva2VuCiAgICAgIH0sIGZ1bmN0aW9uIChzdWNjZXNzKSB7CiAgICAgICAgLy8g5oqKIHRva2VuIOaUvui/m+WOuwogICAgICAgIGNvbnRleHQuc3RhdGUuc3RvbXAuc3Vic2NyaWJlKCcvdXNlci9xdWV1ZS9jaGF0JywgZnVuY3Rpb24gKG1zZykgewogICAgICAgICAgLy8g6K6i6ZiF5raI5oGv6aKR6YGTCiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhtc2cuYm9keSkKICAgICAgICAgIHZhciByZWNlaXZlTXNnID0gSlNPTi5wYXJzZShtc2cuYm9keSk7IC8vIOaciea2iOaBr+WPkeadpe+8jOWPs+S4i+inkiDlvLnmoYbmj5DnpLoKCiAgICAgICAgICBpZiAoIWNvbnRleHQuc3RhdGUuY3VycmVudFNlc3Npb24gfHwgcmVjZWl2ZU1zZy5mcm9tICE9PSBjb250ZXh0LnN0YXRlLmN1cnJlbnRTZXNzaW9uLnVzZXJuYW1lKSB7CiAgICAgICAgICAgIE5vdGlmaWNhdGlvbi5pbmZvKHsKICAgICAgICAgICAgICB0aXRsZTogJ+OAkCcgKyByZWNlaXZlTXNnLmZvcm1OaWNrTmFtZSArICfjgJHlj5HmnaXkuIDmnaHmtojmga8nLAogICAgICAgICAgICAgIG1lc3NhZ2U6IHJlY2VpdmVNc2cuY29udGVudC5sZW5ndGggPiAxMCA/IHJlY2VpdmVNc2cuY29udGVudC5zdWJzdHIoMCwgMTApIDogcmVjZWl2ZU1zZy5jb250ZW50LAogICAgICAgICAgICAgIHBvc2l0aW9uOiAnYm90dG9tLXJpZ2h0JwogICAgICAgICAgICB9KTsgLy8g5pyJ5pyq6K+75raI5oGvIOWxleekuuWwj+e6oueCuQoKICAgICAgICAgICAgVnVlLnNldChjb250ZXh0LnN0YXRlLmlkRG90LCBjb250ZXh0LnN0YXRlLmN1cnJlbnRBZG1pbi51c2VybmFtZSArICcjJyArIHJlY2VpdmVNc2cuZnJvbSwgdHJ1ZSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmVjZWl2ZU1zZy5ub3RTZWxmID0gdHJ1ZTsKICAgICAgICAgIHJlY2VpdmVNc2cudG8gPSByZWNlaXZlTXNnLmZyb207CiAgICAgICAgICBjb250ZXh0LmNvbW1pdCgnYWRkTWVzc2FnZScsIHJlY2VpdmVNc2cpOyAvLyDmjqXmlLYKICAgICAgICB9KTsKICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7fSk7CiAgICB9LAogICAgaW5pdERhdGE6IGZ1bmN0aW9uIGluaXREYXRhKGNvbnRleHQpIHsKICAgICAgY29udGV4dC5jb21taXQoJ0lOSVRfREFUQScpOyAvLyAxLTQg6LCD55So5o6l5Y+j6I635Y+W5pWw5o2uCgogICAgICBnZXRSZXF1ZXN0KCcvY2hhdC9hZG1pbicpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgY29udGV4dC5jb21taXQoJ0lOSVRfQURNSU5TJywgcmVzcCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn0pOwpzdG9yZS53YXRjaChmdW5jdGlvbiAoc3RhdGUpIHsKICByZXR1cm4gc3RhdGUuc2Vzc2lvbnM7Cn0sIGZ1bmN0aW9uICh2YWwpIHsKICBjb25zb2xlLmxvZygnQ0hBTkdFOiAnLCB2YWwpOwogIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd2dWUtY2hhdC1zZXNzaW9uJywgSlNPTi5zdHJpbmdpZnkodmFsKSk7Cn0sIHsKICBkZWVwOiB0cnVlCiAgLyrov5nkuKrosozkvLzmmK/lvIDlkK93YXRjaOebkea1i+eahOWIpOaWrSzlrpjmlrnor7TmmI7kuZ/mr5TovoPmqKHns4oqLwoKfSk7CmV4cG9ydCBkZWZhdWx0IHN0b3JlOw=="},{"version":3,"sources":["D:/广理学习/JAVA框架项目/乐字节-云E办/乐字节-云E办前端/yeb/src/store/index.js"],"names":["Vue","Vuex","getRequest","SockJS","Stomp","Notification","use","now","Date","store","Store","state","routes","sessions","admins","currentAdmin","JSON","parse","window","sessionStorage","getItem","currentSession","filterKey","stomp","idDot","mutations","INIT_ADMIN","admin","initRoutes","data","changecurrentSession","set","username","addMessage","msg","mss","to","push","content","date","self","notSelf","INIT_DATA","localStorage","INIT_ADMINS","actions","connect","context","over","token","success","subscribe","receiveMsg","body","from","info","title","formNickName","message","length","substr","position","commit","error","initData","then","resp","watch","val","console","log","setItem","stringify","deep"],"mappings":"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","sourcesContent":["import Vue from 'vue'\nimport Vuex from 'vuex'\nimport {getRequest} from \"@/utils/api\";\nimport SockJS from 'sockjs-client' // 2-1 在线聊天-导入下载的在线聊天依赖\nimport Stomp from 'stompjs' // 2-1 在线聊天-导入下载的在线聊天依赖\nimport {Notification} from 'element-ui';\n\nVue.use(Vuex)\nconst now = new Date();\n\n// 导入 Vuex\nconst store = new Vuex.Store({\n    state: {\n        routes: [],\n        sessions: {},\n        // sessions: [],\n        // 1-1 用来接收后端接口返回的数据\n        admins: [],\n        currentAdmin: JSON.parse(window.sessionStorage.getItem('user')), // 当前用户\n        currentSession: null,\n        // currentSession: -1,\n        filterKey: '',\n        stomp: null, // 2-2 在线聊天-定义对象\n        idDot: {} // 未读消息 对象\n    },\n    mutations: { // 与 state 同步执行；可以改变 state 对应的值的方法\n        // 编辑用户 同步用户信息\n        INIT_ADMIN(state, admin) {\n            state.currentAdmin = admin\n        },\n        // 初始化路由 菜单\n        initRoutes(state, data) {\n            state.routes = data\n        },\n        changecurrentSession(state, currentSession) {\n            state.currentSession = currentSession;\n            // 已读消息 小红点消失\n            Vue.set(state.idDot, state.currentAdmin.username + '#' + state.currentSession.username, false)\n        },\n        addMessage(state, msg) {\n            let mss = state.sessions[state.currentAdmin.username + '#' + msg.to]\n            if (!mss) {\n                // state.sessions[state.currentAdmin.username + '#' + msg.to] = []\n                Vue.set(state.sessions, state.currentAdmin.username + '#' + msg.to, [])\n            }\n            state.sessions[state.currentAdmin.username + '#' + msg.to].push\n            ({\n                content: msg.content,\n                date: new Date(),\n                self: !msg.notSelf // 不是自己\n            })\n        },\n        INIT_DATA(state) {\n            // 1-2 注释这一段 浏览器本地的历史聊天记录\n            let data = localStorage.getItem('vue-chat-session');\n            //console.log(data)\n            if (data) {\n                state.sessions = JSON.parse(data);\n            }\n        },\n        // 1-3 初始化数据\n        INIT_ADMINS(state, data) {\n            state.admins = data\n        }\n    },\n    // 异步执行\n    actions: {\n        // 2-3 在线聊天; context 上下文\n        connect(context) {\n            context.state.stomp = Stomp.over(new SockJS('/ws/ep')) // 连接端点\n            let token = window.sessionStorage.getItem('tokenStr')\n            context.state.stomp.connect({'Auth-Token': token}, success => { // 把 token 放进去\n                context.state.stomp.subscribe('/user/queue/chat', msg => { // 订阅消息频道\n                    // console.log(msg.body)\n                    let receiveMsg = JSON.parse(msg.body)\n                    // 有消息发来，右下角 弹框提示\n                    if (!context.state.currentSession || receiveMsg.from !== context.state.currentSession.username) {\n                        Notification.info({\n                            title: '【' + receiveMsg.formNickName + '】发来一条消息',\n                            message: receiveMsg.content.length > 10 ? receiveMsg.content.substr(0, 10) : receiveMsg.content,\n                            position: 'bottom-right'\n                        })\n                        // 有未读消息 展示小红点\n                        Vue.set(context.state.idDot, context.state.currentAdmin.username + '#' + receiveMsg.from, true)\n                    }\n                    receiveMsg.notSelf = true;\n                    receiveMsg.to = receiveMsg.from\n                    context.commit('addMessage', receiveMsg) // 接收\n                })\n            }, error => {\n            })\n        },\n        initData(context) {\n            context.commit('INIT_DATA')\n            // 1-4 调用接口获取数据\n            getRequest('/chat/admin').then(resp => {\n                if (resp) {\n                    context.commit('INIT_ADMINS', resp)\n                }\n            })\n        }\n    }\n})\n\nstore.watch(function (state) {\n    return state.sessions\n}, function (val) {\n    console.log('CHANGE: ', val);\n    localStorage.setItem('vue-chat-session', JSON.stringify(val));\n}, {\n    deep: true/*这个貌似是开启watch监测的判断,官方说明也比较模糊*/\n})\n\n\nexport default store;\n"]}]}